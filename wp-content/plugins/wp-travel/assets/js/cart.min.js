function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{};b%2?ownKeys(Object(c),!0).forEach(function(b){_defineProperty(a,b,c[b])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):ownKeys(Object(c)).forEach(function(b){Object.defineProperty(a,b,Object.getOwnPropertyDescriptor(c,b))})}return a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}jQuery(document).ready(function(a){"undefined"!=typeof parsley&&a(".wp-travel-add-to-cart-form").parsley(),a(".wp-travel-add-to-cart-form").submit(function(b){b.preventDefault();var c="#"+a(this).attr("id"),d={};a(c+" input, "+c+" select").each(function(b){var c=a(this).attr("name"),e=a(this).val();if(1==a(this).data("multiple")){if(void 0===d[c]&&(d[c]=[]),"checkbox"==a(this).attr("type")&&a(this).is(":checked")&&d[c].push(e),1==a(this).data("dependent")){var f=a(this).data("parent");a("#"+f).is(":checked")&&d[c].push(e)}}else d[c]=e}),d.action="wt_add_to_cart",d._nonce=wp_travel._nonce,a.ajax({type:"POST",url:wp_travel.ajaxUrl,data:d,beforeSend:function(){},success:function(a){wp_travel.isEnabledCartPage?location.href=wp_travel.cartUrl:location.href=wp_travel.checkoutUrl}})}),a(".wp-travel-cart-remove").click(function(b){if(b.preventDefault(),confirm(wp_travel.strings.confirm)){var c=a(this).data("cart-id");a.ajax({type:"POST",url:wp_travel.ajaxUrl,data:{action:"wt_remove_from_cart",cart_id:c},beforeSend:function(){},success:function(a){location.href=wp_travel.cartUrl}})}}),a(".wp-travel-update-cart-btn").click(function(b){b.preventDefault();var c={};a(".ws-theme-cart-page tr.responsive-cart").each(function(b){var d=a(this).find('input[name="cart_id"]').val(),e=a(this).find('input[name="pricing_id"]').val(),f=!1,g=!1,h={};a(this).find("input.wp-travel-trip-pax").each(function(){h[a(this).data("category-id")]=this.value});var i={};i.extras={},i.extras.id={},i.extras.qty={},i.pax=h,i.pricing_id=e,i.cart_id=d,a(this).next(".child_products").find('input[name="extra_id"]').length>0&&a(this).next(".child_products").find('input[name="extra_id"]').each(function(b){f=a(this).val(),i.extras.id[b]=f}),a(this).next(".child_products").find('input[name="extra_qty"]').length>0&&a(this).next(".child_products").find('input[name="extra_qty"]').each(function(b){g=a(this).val(),i.extras.qty[b]=g}),c[b]=i}),a.ajax({type:"POST",url:wp_travel.ajaxUrl,data:{update_cart_fields:c,action:"wt_update_cart"},beforeSend:function(){},success:function(a){a&&location.reload()}})}),a(".wp-travel-apply-coupon-btn").click(function(b){b.preventDefault();var c={};a(".ws-theme-cart-page tr.responsive-cart").each(function(b){trip_id=a(this).find('input[name="trip_id"]').val(),c[b]=trip_id});var d=a('input[name="wp_travel_coupon_code_input"]').val();a.ajax({type:"POST",url:wp_travel.ajaxUrl,data:{trip_ids:c,CouponCode:d,action:"wt_cart_apply_coupon"},beforeSend:function(){},success:function(a){a&&location.reload()}})}),a(".wp-travel-pax, .wp-travel-tour-extras-qty").on("change",function(){a(".wp-travel-update-cart-btn").removeAttr("disabled","disabled"),a(".book-now-btn").attr("disabled","disabled")}),a(document).on("click",".wp-travel-add-traveller",function(b){b.preventDefault();var c=a(this).parent(".text-center").siblings(".payment-content").find(".payment-traveller").length,d=a(".payment-content .payment-traveller:last").data("unique-index");d?d+=1:d=c;var e=a(this).data("cart-id"),f=wp.template("traveller-info");a(this).closest(".text-center").siblings(".payment-content").append(JSON.parse(f({index:c,cart_id:e,unique_index:d})))}),a(document).on("click",".traveller-remove",function(b){b.preventDefault(),confirm("Are you sure you want to traveler?")&&(a(this).closest(".payment-traveller").remove(),a(".payment-traveller.added").each(function(b){a(this).find(".traveller-index").html(b+1)}))}),a(document).on("click, change",".wp-travel-pax",function(){var b=a(this),c=b.closest(".product-price"),d=c.data("maxPax"),e=c.data("minPax"),f=0;c.find(".wp-travel-pax").each(function(a){f+=parseInt(this.value)}),f>d?(alert(wp_travel.strings.alert.max_pax_alert.replace("{max_pax}",d)),b.val(parseInt(d)+parseInt(b.val())-parseInt(f)),a(".wp-travel-update-cart-btn").removeAttr("disabled")):f<e?(alert(wp_travel.strings.alert.min_pax_alert.replace("{min_pax}",e)),a(".wp-travel-update-cart-btn").attr("disabled","disabled")):a(".wp-travel-update-cart-btn").removeAttr("disabled")})});var wp_travel_cart={};wp_travel_cart.format=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"currency",c=wp_travel,d=(c.currency,c.currency_symbol),e=c.currency_position,f=c.decimal_separator,g=c.number_of_decimals,h=c.thousand_separator,i=new RegExp("\\d(?=(\\d{3})+\\".concat(f,")"),"gi"),j="$&".concat(h),k=parseFloat(a).toFixed(g).replace(/\./,f).replace(i,j);return"decimal"==b?k:{left:"".concat(d,"<span>").concat(k,"</span>"),left_with_space:"".concat(d," <span>").concat(k,"</span>"),right:"<span>".concat(k,"</span>").concat(d),right_with_space:"<span>".concat(k,"</span> ").concat(d)}[e]},wp_travel_cart.timeout=function(a,b){return new Promise(function(c,d){setTimeout(function(){d(new Error("request timeout"))},b),c(a.then(c,d))})};var wptravelcheckout=function(a){var b=document.getElementById("wp-travel-book-now");if(b&&b.addEventListener("wptcartchange",function(a){a.target.disabled=!0}),b&&b.addEventListener("click",function(a){}),a){var c=a&&a.querySelectorAll("[data-cart-id]");if(!(c&&c.length<=0)){var d=function(){var c=a.querySelectorAll("[data-dirty]");b&&(c&&c.length>0?b.disabled=!0:b.disabled=!1)},e=function(a){a?f.removeAttribute("style"):f.style.display="none"},f=a.querySelector(".wp-travel-cart-loader");f&&e(!0),wp_travel&&wp_travel_cart.timeout(fetch("".concat(wp_travel.ajaxUrl,"?action=wp_travel_get_cart&_nonce=").concat(wp_travel._nonce)).then(function(a){a.json().then(function(a){e(),a.success&&"WP_TRAVEL_CART"===a.data.code&&a.data.cart&&(wp_travel_cart.cart=a.data.cart,Object.freeze(wp_travel_cart.cart))})}),1e4).catch(function(a){alert("[X] Request Timeout!"),e()});var g=function(b){var c={},d=0,e=0,f=0,g=0,h=wp_travel_cart.cart&&wp_travel_cart.cart.cart_items&&wp_travel_cart.cart.cart_items[b],i=a.querySelector('[data-cart-id="'.concat(b,'"]')),j=h.trip_data.pricings.find(function(a){return a.id==parseInt(h.pricing_id)}),k=j.categories,l=j.trip_extras,m=i.querySelectorAll("[data-wpt-category-count]"),n=h.trip_data&&h.trip_data.minimum_partial_payout_percent;i.querySelectorAll("[data-wpt-category]").forEach(function(a){var b=a.querySelector("[data-wpt-category-total]"),c=a.querySelector("[data-wpt-category-count-input]"),f=a.querySelector("[data-wpt-category-price]"),h=k.find(function(b){return b.id==parseInt(a.dataset.wptCategory)}),i=h&&h.is_sale?parseFloat(h.sale_price):parseFloat(h.regular_price),j=c&&parseInt(c.value)||0;if(h.has_group_price){var l=h.group_prices.find(function(a){return j>=parseInt(a.min_pax)&&j<=parseInt(a.max_pax)});i=l&&l.price||i,f&&(f.innerHTML=wp_travel_cart.format(i))}var o="group"==h.price_per?j>0&&i||0:i*j;m&&m.forEach(function(b){b.dataset.wptCategoryCount==a.dataset.wptCategory&&(b.innerHTML=j)}),b&&(b.innerHTML=wp_travel_cart.format(o)),g+=parseFloat(o),d+=parseFloat(o),e+=parseFloat(o)*parseFloat(n)/100});var o=i.querySelectorAll("[data-wpt-tx]");return o&&o.forEach(function(a){var b=l.find(function(b){return b.id==parseInt(a.dataset.wptTx)});if(b.tour_extras_metas){var c=a.querySelector("[data-wpt-tx-total]"),d=a.querySelector("[data-wpt-tx-count-input]"),e=b.is_sale&&b.tour_extras_metas.extras_item_sale_price||b.tour_extras_metas.extras_item_price,h=d&&d.value||0,i=parseFloat(e)*parseInt(h);c&&(c.innerHTML=wp_travel_cart.format(i)),g+=i,f+=i}}),c={tripTotalWOExtras:d,tripTotalPartialWOExtras:e,extrasTotal:f,tripTotal:g},i.querySelector("[data-wpt-item-total]").innerHTML=wp_travel_cart.format(g),c};a&&a.addEventListener("wptcartchange",function(a){var b=0,c=0,d=0,e=0,f=document.querySelectorAll("[data-wpt-cart-total]"),h=document.querySelectorAll("[data-wpt-cart-partial-total]"),i=a.target.querySelector("[data-wpt-cart-subtotal]"),j=a.target.querySelector("[data-wpt-cart-discount]"),k=a.target.querySelector("[data-wpt-cart-tax]"),l=a.target.querySelectorAll("[data-cart-id]");if(l&&l.forEach(function(a){var f=g(a.dataset.cartId);b+=f.tripTotal,c+=f.tripTotalWOExtras,e+=f.tripTotalPartialWOExtras,d+=f.extrasTotal}),i&&(i.innerHTML=wp_travel_cart.format(b)),a.detail&&a.detail.coupon||wp_travel_cart.cart.coupon&&wp_travel_cart.cart.coupon.coupon_id){var m=a.detail&&a.detail.coupon||wp_travel_cart.cart.coupon,n=m.value&&parseInt(m.value)||0;j&&(j.innerHTML="fixed"==m.type?"- "+wp_travel_cart.format(n):"- "+wp_travel_cart.format(b*n/100),j.closest("[data-wpt-extra-field]").removeAttribute("style")),b="fixed"==m.type?b-n:b*(100-n)/100}wp_travel_cart.cart.total.discount<=0&&(j.closest("[data-wpt-extra-field]").style.display="none"),wp_travel_cart.cart.tax&&(k&&(k.innerHTML="+ "+wp_travel_cart.format(b*parseInt(wp_travel_cart.cart.tax)/100)),b=b*(100+parseInt(wp_travel_cart.cart.tax))/100),f&&f.forEach(function(a){return a.innerHTML=wp_travel_cart.format(b)}),h&&h.forEach(function(a){var b=e+d;wp_travel_cart.cart.tax&&(b=b*(100+parseFloat(wp_travel_cart.cart.tax))/100),a.innerHTML=wp_travel_cart.format(b)});var o=a.target.querySelector("[data-wpt-cart-item-count]");o&&(o.innerHTML=l.length)}),c&&c.forEach(function(c){var d=c.querySelector("a.edit"),f=c.querySelector(".update-fields-collapse"),g=c.querySelector(".del-btn"),h=c.querySelector(".wp-travel-cart-loader");g&&g.addEventListener("click",function(b){b.preventDefault(),confirm(g.dataset.l10n)&&(e(!0),wp_travel_cart.timeout(fetch("".concat(wp_travel.ajaxUrl,"?action=wp_travel_remove_cart_item&_nonce=").concat(wp_travel._nonce,"&cart_id=").concat(c.dataset.cartId)).then(function(a){return a.json()}).then(function(b){if(b.success&&"WP_TRAVEL_REMOVED_CART_ITEM"==b.data.code){window.location.reload(),wp_travel_cart.cart=b.data.cart;var d=b.data.cart.total;wp_travel.payment&&(wp_travel.payment.trip_price=parseFloat(d.total),wp_travel.payment.payment_amount=parseFloat(d.total_partial)),c.remove(),a.dispatchEvent(new Event("wptcartchange")),e()}}),1e4).catch(function(a){alert("[X] Request Timeout!"),e()}))}),d&&d.addEventListener("click",function(a){if(f.className.indexOf("active")<0?(f.style.display="block",f.classList.add("active")):(f.style.display="none",f.classList.remove("active")),!(f.className.indexOf("active")<0)){var b=a.target.dataset.wptTargetCartId,d=wp_travel_cart.cart.cart_items&&wp_travel_cart.cart.cart_items[b]||{};if(d.trip_data&&d.trip_data.inventory&&"yes"===d.trip_data.inventory.enable_trip_inventory){var e="",g=d.pricing_id||0;e+=g&&"pricing_id=".concat(g)||"";var i=d.trip_data&&d.trip_data.id||0;e+=i&&"&trip_id=".concat(i)||"";var j=d.trip_time;if(e+=j&&"&trip_time=".concat(j)||"",d.arrival_date&&"invalid date"!=new Date(d.arrival_date).toString().toLowerCase()){var k=new Date(d.arrival_date),l=k.getFullYear(),m=k.getMonth()+1;m=String(m).padStart(2,"0");var n=String(k.getDate()).padStart(2,"0");k="".concat(l,"-").concat(m,"-").concat(n),e+=k&&"&selected_date=".concat(k)||""}h.removeAttribute("style"),wp_travel_cart.timeout(fetch("".concat(wp_travel.ajaxUrl,"?").concat(e,"&action=wp_travel_get_inventory&_nonce=").concat(wp_travel._nonce)).then(function(a){return a.json().then(function(a){if(h.style.display="none",a.success&&"WP_TRAVEL_INVENTORY_INFO"===a.data.code&&a.data.inventory.length>0){var b=a.data.inventory[0];c.querySelectorAll("[data-wpt-category-count-input]").forEach(function(a){return a.max=b.pax_available})}})})).catch(function(a){alert("[X] Request Timeout!"),h.style.display="none"})}}});var i=c.querySelectorAll("[data-wpt-category], [data-wpt-tx]");i&&i.forEach(function(d){var e=d.querySelector("[data-wpt-category-count-input], [data-wpt-tx-count-input]"),f=d.querySelectorAll("[data-wpt-count-up],[data-wpt-count-down]");f&&f.forEach(function(d){d.addEventListener("click",function(f){f.preventDefault();var g=0;if(c.querySelectorAll("[data-wpt-category-count-input]").forEach(function(a){g+=parseInt(a.value)}),void 0!==d.dataset.wptCountUp)if(e&&e.dataset.wptCategoryCountInput){var h=parseInt(e.value)+1<0?0:parseInt(e.value)+1;g+1<=parseInt(e.max)&&h>=parseInt(e.min)&&(e.value=h)}else e.value=parseInt(e.value)+1;if(void 0!==d.dataset.wptCountDown)if(e&&e.dataset.wptCategoryCountInput){var i=parseInt(e.value)-1<0?0:parseInt(e.value)-1;g-1<=parseInt(e.max)&&i>=parseInt(e.min)&&(e.value=i)}else e.value=parseInt(e.value)-1<parseInt(e.min)?e.min:parseInt(e.value)-1;a.dispatchEvent(new Event("wptcartchange")),b&&b.dispatchEvent(new Event("wptcartchange")),c.querySelector('form [type="submit"]').disabled=!1,c.querySelector("h5 a").style.color="orange"})})})}),c&&c.forEach(function(a){var b=a.querySelector(".wp-travel-cart-loader"),c=a.querySelectorAll("[data-wpt-category]"),e=a.querySelectorAll("[data-wpt-tx]"),f=a.querySelector("form");f.addEventListener("submit",function(g){g.preventDefault();var h=f.querySelector('[type="submit"]');h.disabled=!0,b.removeAttribute("style");var i=a.dataset.cartId,j={};c&&c.forEach(function(a){var b=a.querySelector("[data-wpt-category-count-input]"),c=a.dataset.wptCategory,d=b&&b.value;j=_objectSpread(_objectSpread({},j),{},_defineProperty({},c,d))});var k={};e&&e.forEach(function(a){var b=a.querySelector("[data-wpt-tx-count-input]"),c=a.dataset.wptTx,d=b&&b.value;k=_objectSpread(_objectSpread({},k),{},_defineProperty({},c,d))});var l={pax:j,wp_travel_trip_extras:{id:Object.keys(k),qty:Object.values(k)}};wp_travel_cart.timeout(fetch("".concat(wp_travel.ajaxUrl,"?action=wp_travel_update_cart_item&cart_id=").concat(i,"&_nonce=").concat(wp_travel._nonce),{method:"POST",body:JSON.stringify(l)}).then(function(a){return a.json()}).then(function(c){if(b.style.display="none",c.success){wp_travel_cart.cart=c.data.cart;var e=c.data.cart.total;wp_travel.payment&&(wp_travel.payment.trip_price=parseFloat(e.total),wp_travel.payment.payment_amount=parseFloat(e.total_partial)),d(),a.querySelector("h5 a").removeAttribute("style"),location.reload()}else h.disabled=!1}),1e4).catch(function(a){alert("[X] Request Timeout!"),b.style.display="none",h.disabled=!1})})});var h=document.getElementById("wp-travel-payment-mode");h&&h.addEventListener("change",function(a){var b=document.querySelector("#shopping-cart"),c=b&&b.querySelector("[data-wpt-cart-partial-total]")&&b.querySelector("[data-wpt-cart-partial-total]").closest("p"),d=b&&b.querySelectorAll("[data-wpt-trip-partial-total]")&&b.querySelectorAll("[data-wpt-trip-partial-total]"),e=b&&b.querySelectorAll(".wp-travel-payable-amount")&&b.querySelector(".wp-travel-payable-amount"),f=b&&b.querySelectorAll("[data-wpt-trip-partial-gross-total]")&&b.querySelector("[data-wpt-trip-partial-gross-total]");"partial"===a.target.value?(c&&"none"==c.style.display&&c.removeAttribute("style"),d.forEach(function(a){return a.removeAttribute("style")}),f.removeAttribute("style"),f.classList.add("selected-payable-amount"),e.classList.remove("selected-payable-amount")):(c&&(c.style.display="none"),d.forEach(function(a){return a.style.display="none"}),f.style.display="none",f.classList.remove("selected-payable-amount"),e.classList.add("selected-payable-amount"))});var i=document.getElementById("wp-travel-coupon-form"),j=i&&i.querySelector("button"),k=i&&i.querySelector(".coupon-input-field");k&&k.addEventListener("keyup",function(a){l(a.target),a.target.value.length>0&&a.target.removeAttribute("style")});var l=function(a,b){if(b){var c=document.createElement("p");c.classList.add("error"),c.innerHTML=b,a.after(c)}else{var d=a.parentElement.querySelector(".error");d&&d.remove()}};j&&k&&j.addEventListener("click",function(b){b.preventDefault(),k.value.length<=0?(k.style.borderColor="red",k.focus()):(e(!0),b.target.disabled=!0,wp_travel_cart.timeout(fetch("".concat(wp_travel.ajaxUrl,"?action=wp_travel_apply_coupon&_nonce=").concat(wp_travel._nonce),{method:"POST",body:JSON.stringify({couponCode:k.value})}).then(function(a){return a.json()}).then(function(c){e(),c.success?(wp_travel_cart.cart=c.data.cart,k.toggleAttribute("readonly"),b.target.innerHTML=b.target.dataset.successL10n,b.target.style.backgroundColor="green",a.dispatchEvent(new CustomEvent("wptcartchange",{detail:{coupon:c.data.cart.coupon}})),location.reload()):(k.focus(),l(k,c.data[0].message),b.target.disabled=!1)}),1e4).catch(function(a){alert("[X] Request Timeout!"),e()}))})}}};document.getElementById("shopping-cart")&&wptravelcheckout(document.getElementById("shopping-cart"));
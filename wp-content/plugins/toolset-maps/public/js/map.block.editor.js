!function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s="./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/index.js")}({"./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/edit.js":function(e,t,o){"use strict";(function(e){o.d(t,"a",(function(){return _}));var n=o("@wordpress/element"),r=o("@wordpress/i18n"),a=o("./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/inspector/inspector.js"),i=o("./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/render/server-side-render-map.js"),s=o("@wordpress/hooks"),c=o("@wordpress/compose"),l=o("@wordpress/editor"),u=o("@wordpress/data"),p=o("ToolsetDynamicSources"),m=o("@wordpress/components"),d=o("lodash");function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t,o,n,r,a,i){try{var s=e[a](i),c=s.value}catch(e){return void o(e)}s.done?t(c):Promise.resolve(c).then(n,r)}function h(e){return function(){var t=this,o=arguments;return new Promise((function(n,r){var a=e.apply(t,o);function i(e){g(a,n,r,i,s,"next",e)}function s(e){g(a,n,r,i,s,"throw",e)}i(void 0)}))}}function b(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=C(e);if(t){var r=C(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return k(this,o)}}function k(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?w(e):t}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var _="markerDynamicAddress",M=window.toolset_map_block_strings,O=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(g,t);var o,n,c,f=y(g);function g(t,o){var n;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g),S(w(n=f.call(this,t,o)),"getNextMapId",(function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return M.mapCounter++,e&&n.updateCounters(),"map-"+M.mapCounter})),S(w(n),"getNextMarkerId",(function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return M.markerCounter++,e&&n.updateCounters(),"marker-"+M.markerCounter})),S(w(n),"updateCounters",(function(){e.jQuery.ajax({type:"POST",url:window.ajaxurl,data:{action:"wpv_toolset_maps_addon_update_counters",map_counter:M.mapCounter,marker_counter:M.markerCounter,wpnonce:window.wpv_addon_maps_dialogs_local.nonce},dataType:"json"})})),S(w(n),"updateBlockContentFromCache",h(regeneratorRuntime.mark((function e(){var t,o,r,a,i,s,c,l,u,m,d,f,g,h,b,v,y,k;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.props,o=t.attributes,r=t.setAttributes,a=t.post,i=t.previewPost,s=o.markerSource,c=o.markerDynamicAddress,l=o.markerAddress,u=JSON.parse(s),m=JSON.parse(c),d=JSON.parse(l),f=i||a,-1!==(g=u.indexOf("dynamic"))){e.next=9;break}return e.abrupt("return");case 9:return h=m[g],b=h.postProvider,v=h.source,y=h.field?h.field:null,e.next=15,Object(p.fetchDynamicContent)(b,f,v,y);case 15:(k=e.sent)&&k.sourceContent!==d[g]&&(d[g]=k.sourceContent,r({markerAddress:JSON.stringify(d)}));case 17:case"end":return e.stop()}}),e)})))),S(w(n),"isParentBlockOfType",(function(e,t){var o=Object(u.select)("core/editor"),n=o.getBlock,r=o.getBlockRootClientId,a=e;do{if(""!==(a=r(a))){var i=n(a);if(!i)return!1;if(t.includes(i.name))return!0}}while(""!==a);return!1})),!t.attributes.mapId){t.attributes.mapId=n.getNextMapId(!1);var r=JSON.parse(t.attributes.markerId);r[0]=n.getNextMarkerId(!1),t.attributes.markerId=JSON.stringify(r),n.updateCounters()}return n}return o=g,(n=[{key:"componentDidMount",value:function(){Object(s.addAction)("tb.caching.updated","toolset-blocks",this.updateBlockContentFromCache)}},{key:"render",value:function(){var e=this,t=this.props,o=t.attributes,n=t.setAttributes;if(this.isParentBlockOfType(t.clientId,["toolset-views/view-template-block","toolset-views/view-editor"]))return React.createElement(m.Notice,{status:"error",isDismissible:!1},Object(r.__)("Map block cannot be inside the View block. If you want map markers to come from a View, place the Map block outside the View and in the Marker section, select View block for the Source for the marker option.","toolset-maps"));var s=["markerId","markerAddress","markerSource","currentVisitorLocationRenderTime","markerLat","markerLon","markerTitle","popupContent","markerUseMapIcon","markerIcon","markerIconUseDifferentForHover","markerIconHover","markerDynamicAddress","markerView","markerPreviewView","markerViewField"],c=function(e){var t=Object(d.clone)(e);return s.forEach((function(e){t[e]=JSON.parse(t[e])})),t},u=function(){return Object(d.flatten)(Object(d.map)(e.props.blocks,(function(e){return function e(t){return t.innerBlocks.length?Object(d.flatten)(Object(d.concat)(Object(d.map)(t.innerBlocks,(function(t){return e(t)})),t)):t}(e)})))},p=function(){return Object(d.concat)(Object(d.filter)(e.props.blocks,{name:"toolset/view"}),Object(d.filter)(u(),{name:"toolset-views/view-editor"}),Object(d.filter)(u(),{name:"toolset-views/wpa-editor"}))},f=function(e,o,n){var r=JSON.parse(t.attributes[e]),a={};r[n]="string"==typeof o?o.replace(/"/g,"'"):o,a[e]=JSON.stringify(r),t.setAttributes(a)},g=function(e,o){var n=JSON.parse(t.attributes[e]),r={};n[o]=!n[o],r[e]=JSON.stringify(n),t.setAttributes(r)},h=function(e){var o={};s.forEach((function(t){o[t]=JSON.stringify(e[t])})),t.setAttributes(o)};return[!(!t.focus&&!t.isSelected||!M.apiKey)&&React.createElement(a.a,{key:"toolset-gutenberg-map-block-inspector",clientId:t.clientId,attributes:c(t.attributes),onChangeMapId:function(e){return t.setAttributes({mapId:e})},onChangeMapWidth:function(e){return t.setAttributes({mapWidth:e})},onChangeMapHeight:function(e){return t.setAttributes({mapHeight:e})},onChangeMapZoomAutomatic:function(){t.setAttributes({mapZoomAutomatic:!t.attributes.mapZoomAutomatic})},onChangeMapZoomLevelForMultipleMarkers:function(e){t.setAttributes({mapZoomLevelForMultipleMarkers:e})},onChangeMapZoomLevelForSingleMarker:function(e){t.setAttributes({mapZoomLevelForSingleMarker:e})},onChangeMapCenterLat:function(e){return t.setAttributes({mapCenterLat:e})},onChangeMapCenterLon:function(e){return t.setAttributes({mapCenterLon:e})},onChangeMapForceCenterSettingForSingleMarker:function(){return t.setAttributes({mapForceCenterSettingForSingleMarker:!t.attributes.mapForceCenterSettingForSingleMarker})},onChangeMapMarkerClustering:function(){"google"!==M.api||o.mapMarkerClustering||void 0!==window.MarkerClusterer?n({mapMarkerClustering:!o.mapMarkerClustering}):(window.views_addon_maps_clusterer_i10n={cluster_default_imagePath:M.assetsURL+"/resources/images/clusterer/m"},jQuery.getScript(M.assetsURL+"/resources/js/markerclusterer.js").done((function(){n({mapMarkerClustering:!0})})))},onChangeMapMarkerClusteringMinimalNumber:function(e){t.setAttributes({mapMarkerClusteringMinimalNumber:e})},onChangeMapMarkerClusteringMinimalDistance:function(e){t.setAttributes({mapMarkerClusteringMinimalDistance:e})},onChangeMapMarkerClusteringMaximalZoomLevel:function(e){t.setAttributes({mapMarkerClusteringMaximalZoomLevel:e})},onChangeMapMarkerClusteringClickZoom:function(){t.setAttributes({mapMarkerClusteringClickZoom:!t.attributes.mapMarkerClusteringClickZoom})},onChangeMapMarkerSpiderfying:function(){"google"!==M.api||o.mapMarkerSpiderfying||void 0!==window.OverlappingMarkerSpiderfier?n({mapMarkerSpiderfying:!o.mapMarkerSpiderfying}):jQuery.getScript(M.assetsURL+"/resources/js/oms.min.js").done((function(){n({mapMarkerSpiderfying:!0})}))},onChangeMapDraggable:function(){return t.setAttributes({mapDraggable:!t.attributes.mapDraggable})},onChangeMapScrollable:function(){return t.setAttributes({mapScrollable:!t.attributes.mapScrollable})},onChangeMapDoubleClickZoom:function(){t.setAttributes({mapDoubleClickZoom:!t.attributes.mapDoubleClickZoom})},onChangeMapType:function(e){return n({mapType:e})},onChangeMapTypeControl:function(){t.setAttributes({mapTypeControl:!t.attributes.mapTypeControl})},onChangeMapZoomControls:function(){t.setAttributes({mapZoomControls:!t.attributes.mapZoomControls})},onChangeMapStreetViewControl:function(){t.setAttributes({mapStreetViewControl:!t.attributes.mapStreetViewControl})},onChangeMapFullScreenControl:function(){n({mapFullScreenControl:!o.mapFullScreenControl})},onChangeMapBackgroundColor:function(e){return t.setAttributes({mapBackgroundColor:e})},onChangeMapLoadingText:function(e){return t.setAttributes({mapLoadingText:e})},onChangeMapMarkerIcon:function(e){return t.setAttributes({mapMarkerIcon:e})},onChangeMapMarkerIconUseDifferentForHover:function(){return t.setAttributes({mapMarkerIconUseDifferentForHover:!t.attributes.mapMarkerIconUseDifferentForHover})},onChangeMapMarkerIconHover:function(e){return t.setAttributes({mapMarkerIconHover:e})},onChangeMapStyle:function(e){return t.setAttributes({mapStyle:e})},onChangeMapStreetView:function(){t.setAttributes({mapStreetView:!t.attributes.mapStreetView})},onChangeMarkerId:function(e,t){return f("markerId",e,t)},onChangeMarkerAddress:function(e,t){e&&f("markerAddress",e.label,t)},onChangeMarkerSource:function(e,o){var n=JSON.parse(t.attributes.markerView),r=JSON.parse(t.attributes.markerViewField);if("view"===e&&!n[o]){var a=p();if(a.length)if(a[0].attributes.view){var i=a[0].attributes.view;f("markerView",i.ID,o)}else a[0].attributes.viewId&&(f("markerView",a[0].attributes.viewId,o),a[0].attributes.previewId&&f("markerPreviewView",a[0].attributes.previewId,o));r[o]||Object(d.isEmpty)(M.addressFields)||f("markerViewField",Object.keys(M.addressFields)[0],o)}f("markerSource",e,o)},onChangeCurrentVisitorLocationRenderTime:function(e,t){f("currentVisitorLocationRenderTime",e,t)},onAddAnotherMarker:function(){var o=c(t.attributes);o.markerId.push(e.getNextMarkerId()),o.markerAddress.push(""),o.markerSource.push("address"),o.currentVisitorLocationRenderTime.push("immediate"),o.markerLat.push(""),o.markerLon.push(""),o.markerTitle.push(""),o.popupContent.push(""),o.markerUseMapIcon.push(!0),o.markerIcon.push(""),o.markerIconUseDifferentForHover.push(!1),o.markerIconHover.push(""),o.markerDynamicAddress.push({}),o.markerView.push(""),o.markerPreviewView.push(""),o.markerViewField.push(""),h(o)},onRemoveMarker:function(e){var o=c(t.attributes);s.forEach((function(t){o[t].splice(e,1)})),h(o)},onChangeLatitude:function(e,t){return f("markerLat",e,t)},onChangeLongitude:function(e,t){return f("markerLon",e,t)},onChangeMarkerTitle:function(e,t){f("markerTitle",e.replace(/\[/g,"{{").replace(/\]/g,"}}"),t)},onChangePopupContent:function(e,t){return f("popupContent",e.replace(/\[/g,"{{").replace(/\]/g,"}}"),t)},onChangeMarkerUseMapIcon:function(e){var o=c(t.attributes),n=o.mapMarkerIcon,r=o.markerUseMapIcon[e];f("markerIcon",r?n:"",e),g("markerUseMapIcon",e)},onChangeMarkerIcon:function(e,o){var n=c(t.attributes).mapMarkerIcon;!e&&n&&(e="default"),f("markerIcon",e,o)},onChangeMarkerIconUseDifferentForHover:function(e){g("markerIconUseDifferentForHover",e)},onChangeMarkerIconHover:function(e,t){f("markerIconHover",e,t)},onChangeMarkerDynamicAddress:function(e,o){var n=c(t.attributes).markerDynamicAddress[o];(Object(d.isEmpty)(n)||null===e)&&(n={postProvider:null,source:null,field:null,customPost:null,isActive:!0}),e&&(n.postProvider=e.postProvider,n.source=e.source,n.field=e.field,n.customPost=e.customPost),f("markerDynamicAddress",n,o)},onChangeMarkerView:function(e,t){f("markerView",e,t),p().some((function(o){if(o.attributes.previewId&&o.attributes.viewId&&Number(o.attributes.viewId)===Number(e))return f("markerPreviewView",o.attributes.previewId,t),!0;f("markerPreviewView","",t)}))},getViewBlocks:p,onChangeMarkerViewField:function(e,t){f("markerViewField",e,t)}}),!!M.apiKey&&React.createElement(i.a,{key:"map-render-".concat(t.clientId),block:M.blockName,attributes:t.attributes}),!M.apiKey&&React.createElement(m.Notice,{key:"toolset-gutenberg-map-block-notice",status:"error",isDismissible:!1,actions:[{label:Object(r.__)("Enter an API key on the Toolset Settings page.","toolset-maps"),url:M.settingsLink}]},React.createElement(m.Dashicon,{icon:"warning"}),Object(r.__)(" You need an API key to use Toolset Map block.","toolset-maps")),React.createElement(l.BlockControls,{key:"controls"},React.createElement(l.BlockAlignmentToolbar,{value:t.attributes.align,controls:["wide","full"],onChange:function(e){return t.setAttributes({align:e})}}))]}}])&&b(o.prototype,n),c&&b(o,c),g}(n.Component),j=Object(c.compose)([Object(u.withSelect)((function(e){var t=e("core/editor"),o=t.getCurrentPostId,n=t.getBlocks,r=e(window.toolsetDynamicSourcesScriptData.dynamicSourcesStore).getPreviewPost;return{post:o(),blocks:n(),previewPost:r()}})),p.withPostPreview])(O);t.b=j}).call(this,o("./node_modules/webpack/buildin/global.js"))},"./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/index.js":function(e,t,o){"use strict";o.r(t);var n=o("@wordpress/components"),r=React.createElement(n.Icon,{className:"toolset-block-icon toolset-block-icon-maps",icon:React.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M17.3 3.3H15V1C15 0.4 14.6 0 14 0H12.7C12.1 0 11.7 0.4 11.7 1V3.3H8.30001V1C8.30001 0.4 7.90001 0 7.30001 0H6.00001C5.40001 0 5.00001 0.4 5.00001 1V3.3H2.70001C2.10001 3.3 1.70001 3.7 1.70001 4.3V19C1.70001 19.6 2.10001 20 2.70001 20H17.4C18 20 18.4 19.6 18.4 19V4.3C18.3 3.8 17.9 3.3 17.3 3.3ZM10 16.4C10 16.4 6.50001 13.5 6.50001 10.9C6.50001 8.9 8.00001 7.4 10 7.4C12 7.4 13.5 8.9 13.5 10.9C13.5 13.5 10 16.4 10 16.4ZM10 8.8C8.60001 8.8 7.40001 10.1 7.80001 11.6C8.00001 12.4 8.60001 13 9.40001 13.2C10.9 13.6 12.2 12.5 12.2 11C12.3 9.8 11.2 8.8 10 8.8Z",fill:"#ED793E"}))}),a=o("./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/edit.js"),i=(o("./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/styles/editor.scss"),wp.i18n.__),s=wp.blocks.registerBlockType,c=window.toolset_map_block_strings;s(c.blockName,{title:i("Map","toolset-maps"),description:i("Add a map and markers to the editor.","toolset-maps"),category:c.blockCategory,icon:r,keywords:[i("Toolset","toolset-maps"),i("map","toolset-maps"),i("shortcode","toolset-maps")],edit:a.b,save:function(){},supports:{html:!1,customClassName:!1},getEditWrapperProps:function(e){var t=e.align;if(["wide","full"].includes(t))return{"data-align":t}}})},"./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/inspector/inspector.js":function(e,t,o){"use strict";o.d(t,"a",(function(){return je}));var n=o("./node_modules/classnames/index.js"),r=o.n(n),a=o("react"),i=o.n(a),s=o("./node_modules/lodash.debounce/index.js"),c=o.n(s),l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(e,t)};function u(e,t){function o(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}var p=function(){return(p=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},m={autoActivateFirstSuggest:!1,disabled:!1,fixtures:[],getSuggestLabel:function(e){return e.description},highlightMatch:!0,ignoreEnter:!1,ignoreTab:!1,initialValue:"",maxFixtures:10,minLength:1,onKeyDown:function(){},onKeyPress:function(){},placeholder:"Search places",queryDelay:250,skipSuggest:function(){return!1},style:{},inputType:"text"},d=["autoCapitalize","autoComplete","autoCorrect","autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","height","inputMode","maxLength","name","onClick","onContextMenu","onCopy","onCut","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onPaste","pattern","placeholder","readOnly","required","size","spellCheck","tabIndex","title","aria-atomic","aria-busy","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-dropeffect","aria-errormessage","aria-flowto","aria-grabbed","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-live","aria-owns","aria-relevant","aria-roledescription","aria-activedescendant","aria-autocomplete","aria-multiline","aria-placeholder","aria-readonly","aria-required"];function f(e){var t={};return Object.keys(e).forEach((function(o){var n=o.startsWith("data-");(d.includes(o)||n)&&(t[o]=e[o])})),t}var g=function(e){function t(t){var o=e.call(this,t)||this;return o.input=null,o.onChange=o.onChange.bind(o),o.onInputKeyDown=o.onInputKeyDown.bind(o),o}return u(t,e),t.prototype.onChange=function(){this.input&&this.props.onChange(this.input.value)},t.prototype.onInputKeyDown=function(e){switch(this.props.onKeyDown&&this.props.onKeyDown(e),e.which){case 40:e.shiftKey||(e.preventDefault(),this.props.onNext());break;case 38:e.shiftKey||(e.preventDefault(),this.props.onPrev());break;case 13:this.props.doNotSubmitOnEnter&&e.preventDefault(),this.props.ignoreEnter||this.props.onSelect();break;case 9:this.props.ignoreTab||this.props.onSelect();break;case 27:this.props.onEscape()}},t.prototype.focus=function(){this.input&&this.input.focus()},t.prototype.blur=function(){this.input&&this.input.blur()},t.prototype.render=function(){var e=this,t=f(this.props),o=r()("geosuggest__input",this.props.className),n=this.props.label&&this.props.id;return t.tabIndex||(t.tabIndex=0),Object(a.createElement)(a.Fragment,null,n&&Object(a.createElement)("label",{className:"geosuggest__label",htmlFor:this.props.id},this.props.label),Object(a.createElement)("input",p({className:o,id:"geosuggest__input"+(this.props.id?"--"+this.props.id:""),ref:function(t){return e.input=t},type:this.props.inputType},t,{value:this.props.value,style:this.props.style,onKeyDown:this.onInputKeyDown,onChange:this.onChange,onKeyPress:this.props.onKeyPress,onFocus:this.props.onFocus,onBlur:this.props.onBlur,role:"combobox","aria-expanded":!this.props.isSuggestsHidden,"aria-activedescendant":this.props.activeSuggest?this.props.activeSuggest.placeId:void 0,"aria-owns":this.props.listId})))},t.defaultProps={activeSuggest:null,autoComplete:"nope",className:"",isSuggestsHidden:!0,listId:"",inputType:"text",onBlur:function(){},onChange:function(){},onEscape:function(){},onFocus:function(){},onKeyDown:function(){},onKeyPress:function(){},onNext:function(){},onPrev:function(){},onSelect:function(){},value:""},t}(a.PureComponent),h=function(e){function t(t){var o=e.call(this,t)||this;return o.ref=null,o.onClick=o.onClick.bind(o),o}return u(t,e),t.prototype.makeBold=function(e,t){return Object(a.createElement)("b",{className:"geosuggest__item__matched-text",key:t},e)},t.prototype.formatMatchedText=function(e,t){if(!e||!t.matchedSubstrings)return t.label;var o=t.matchedSubstrings.offset,n=o+t.matchedSubstrings.length,r=this.makeBold(t.label.substring(o,n),t.label),i="",s="";return o>0&&(i=t.label.slice(0,o)),n<t.label.length&&(s=t.label.slice(n)),Object(a.createElement)("span",null,i,r,s)},t.prototype.componentDidUpdate=function(e){!e.isActive&&this.props.isActive&&this.scrollIfNeeded()},t.prototype.scrollIfNeeded=function(){var e=this.ref,t=e&&e.parentElement;if(e&&t){var o=e.offsetTop-t.offsetTop<t.scrollTop,n=e.offsetTop-t.offsetTop+e.clientHeight>t.scrollTop+t.clientHeight;(o||n)&&(t.scrollTop=e.offsetTop-t.offsetTop-t.clientHeight/2+e.clientHeight/2)}},t.prototype.onClick=function(e){e.preventDefault(),this.props.onSelect(this.props.suggest)},t.prototype.render=function(){var e,t=this,o=this.props.suggest,n=r()("geosuggest__item",this.props.className,this.props.suggestItemClassName,{"geosuggest__item--active":this.props.isActive},((e={})[this.props.activeClassName||""]=this.props.activeClassName?this.props.isActive:null,e)),i=o.label;return this.props.renderSuggestItem?i=this.props.renderSuggestItem(o,this.props.userInput):this.props.isHighlightMatch&&(i=this.formatMatchedText(this.props.userInput,o)),Object(a.createElement)("li",{className:n,ref:function(e){return t.ref=e},style:this.props.style,onMouseDown:this.props.onMouseDown,onMouseOut:this.props.onMouseOut,onClick:this.onClick,role:"option","aria-selected":this.props.isActive,id:o.placeId},i)},t}(a.PureComponent),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.isHidden=function(){return this.props.isHidden||0===this.props.suggests.length},t.prototype.componentDidUpdate=function(e){e.suggests!==this.props.suggests&&0===this.props.suggests.length&&this.props.onSuggestNoResults()},t.prototype.render=function(){var e,t=this,o=r()("geosuggest__suggests",this.props.suggestsClassName,{"geosuggest__suggests--hidden":this.isHidden()},((e={})[this.props.hiddenClassName||""]=this.props.hiddenClassName?this.isHidden():null,e));return Object(a.createElement)("ul",{className:o,style:this.props.style,role:"listbox",id:this.props.listId},this.props.suggests.map((function(e){var o=t.props.activeSuggest&&e.placeId===t.props.activeSuggest.placeId||!1;return Object(a.createElement)(h,{key:e.placeId,className:e.className||"",userInput:t.props.userInput,isHighlightMatch:t.props.isHighlightMatch,suggest:e,style:t.props.suggestItemStyle,suggestItemClassName:t.props.suggestItemClassName,isActive:o,activeClassName:t.props.suggestItemActiveClassName,onMouseDown:t.props.onSuggestMouseDown,onMouseOut:t.props.onSuggestMouseOut,onSelect:t.props.onSuggestSelect,renderSuggestItem:t.props.renderSuggestItem})})))},t}(a.PureComponent);var v=function(e){function t(t){var o=e.call(this,t)||this;return o.googleMaps=null,o.autocompleteService=null,o.placesService=null,o.sessionToken=void 0,o.geocoder=null,o.input=null,o.state={activeSuggest:null,ignoreBlur:!1,isLoading:!1,isSuggestsHidden:!0,suggests:[],userInput:t.initialValue||""},o.onInputChange=o.onInputChange.bind(o),o.onAfterInputChange=o.onAfterInputChange.bind(o),o.onInputFocus=o.onInputFocus.bind(o),o.onInputBlur=o.onInputBlur.bind(o),o.onNext=o.onNext.bind(o),o.onPrev=o.onPrev.bind(o),o.onSelect=o.onSelect.bind(o),o.onSuggestMouseDown=o.onSuggestMouseDown.bind(o),o.onSuggestMouseOut=o.onSuggestMouseOut.bind(o),o.onSuggestNoResults=o.onSuggestNoResults.bind(o),o.hideSuggests=o.hideSuggests.bind(o),o.selectSuggest=o.selectSuggest.bind(o),o.listId="geosuggest__list"+(t.id?"--"+t.id:""),t.queryDelay&&(o.onAfterInputChange=c()(o.onAfterInputChange,t.queryDelay)),o}return u(t,e),t.prototype.componentDidUpdate=function(e){e.initialValue!==this.props.initialValue&&this.setState({userInput:this.props.initialValue||""}),JSON.stringify(e.fixtures)!==JSON.stringify(this.props.fixtures)&&this.searchSuggests()},t.prototype.componentDidMount=function(){if("undefined"!=typeof window){var e=this.props.googleMaps||window.google&&window.google.maps||this.googleMaps;e?(this.googleMaps=e,this.autocompleteService=new e.places.AutocompleteService,this.placesService=new e.places.PlacesService(document.createElement("div")),this.sessionToken=new e.places.AutocompleteSessionToken,this.geocoder=new e.Geocoder):console&&console.error("Google maps API was not found in the page.")}},t.prototype.componentWillUnmount=function(){clearTimeout(this.timer)},t.prototype.onInputChange=function(e){e||this.props.onSuggestSelect&&this.props.onSuggestSelect(),this.setState({userInput:e},this.onAfterInputChange)},t.prototype.onAfterInputChange=function(){this.showSuggests(),this.props.onChange&&this.props.onChange(this.state.userInput)},t.prototype.onInputFocus=function(){this.props.onFocus&&this.props.onFocus(),this.showSuggests()},t.prototype.onInputBlur=function(){this.state.ignoreBlur||this.hideSuggests()},t.prototype.onNext=function(){this.activateSuggest("next")},t.prototype.onPrev=function(){this.activateSuggest("prev")},t.prototype.onSelect=function(){this.selectSuggest(this.state.activeSuggest)},t.prototype.onSuggestMouseDown=function(){this.setState({ignoreBlur:!0})},t.prototype.onSuggestMouseOut=function(){this.setState({ignoreBlur:!1})},t.prototype.onSuggestNoResults=function(){this.props.onSuggestNoResults&&this.props.onSuggestNoResults(this.state.userInput)},t.prototype.focus=function(){this.input&&this.input.focus()},t.prototype.blur=function(){this.input&&this.input.blur()},t.prototype.update=function(e){this.setState({userInput:e}),this.props.onChange&&this.props.onChange(e)},t.prototype.clear=function(){this.setState({userInput:""},this.hideSuggests)},t.prototype.searchSuggests=function(){var e=this;if(this.state.userInput){var t={input:this.state.userInput,sessionToken:this.sessionToken},o=this.state.userInput.length;if(this.props.minLength&&o<this.props.minLength)this.updateSuggests();else{var n=this.props,r=n.location,a=n.radius,i=n.bounds,s=n.types,c=n.country;r&&(t.location=r),a&&(t.radius=Number(this.props.radius)),i&&(t.bounds=i),s&&(t.types=s),c&&(t.componentRestrictions={country:c}),this.setState({isLoading:!0},(function(){e.autocompleteService?e.autocompleteService.getPlacePredictions(t,(function(t){e.setState({isLoading:!1}),e.updateSuggests(t||[],(function(){e.props.autoActivateFirstSuggest&&!e.state.activeSuggest&&e.activateSuggest("next")}))})):e.setState({isLoading:!1})}))}}else this.updateSuggests()},t.prototype.updateSuggests=function(e,t){var o=this;void 0===e&&(e=[]),void 0===t&&(t=function(){});var n,r=[],a=this.state.userInput,i=this.props,s=i.skipSuggest,c=i.maxFixtures,l=i.fixtures,u=new RegExp(a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),"gim"),m=0;l&&l.forEach((function(e){c&&m>=c||s&&!s(e)&&e.label.match(u)&&(m++,r.push(p(p({},e),{isFixture:!0,matchedSubstrings:{length:a.length,offset:e.label.indexOf(a)},placeId:e.placeId||e.label})))})),e.forEach((function(e){s&&!s(e)&&r.push({description:e.description,isFixture:!1,label:o.props.getSuggestLabel?o.props.getSuggestLabel(e):"",matchedSubstrings:e.matched_substrings[0],placeId:e.place_id})})),n=this.updateActiveSuggest(r),this.props.onUpdateSuggests&&this.props.onUpdateSuggests(r,n),this.setState({suggests:r,activeSuggest:n},t)},t.prototype.updateActiveSuggest=function(e){void 0===e&&(e=[]);var t=this.state.activeSuggest;if(t){var o=e.filter((function(e){return t&&t.placeId===e.placeId&&t.isFixture===e.isFixture}))[0];t=o||null}return t},t.prototype.showSuggests=function(){this.searchSuggests(),this.setState({isSuggestsHidden:!1})},t.prototype.hideSuggests=function(){var e=this;this.props.onBlur&&this.props.onBlur(this.state.userInput),this.timer=window.setTimeout((function(){e.setState({activeSuggest:null,isSuggestsHidden:!0})}),100)},t.prototype.activateSuggest=function(e){if(this.state.isSuggestsHidden)this.showSuggests();else{for(var t=this.state.suggests.length-1,o="next"===e,n=null,r=0,a=0;a<=t;a++)this.state.suggests[a]===this.state.activeSuggest&&(r=o?a+1:a-1);this.state.activeSuggest||(r=o?0:t),r>=0&&r<=t&&(n=this.state.suggests[r]),this.props.onActivateSuggest&&this.props.onActivateSuggest(n),this.setState({activeSuggest:n})}},t.prototype.selectSuggest=function(e){var t=e||{isFixture:!0,label:this.state.userInput,placeId:this.state.userInput};if(!e&&this.props.autoActivateFirstSuggest&&this.state.suggests.length>0&&(t=this.state.suggests[0]),this.setState({isSuggestsHidden:!0,userInput:"object"!=typeof t.label?t.label:t.description||""}),t.location)return this.setState({ignoreBlur:!1}),void(this.props.onSuggestSelect&&this.props.onSuggestSelect(t));this.geocodeSuggest(t)},t.prototype.geocodeSuggest=function(e){var t=this;if(this.geocoder)if(e.placeId&&!e.isFixture&&this.placesService){var o={placeId:e.placeId,sessionToken:this.sessionToken};this.props.placeDetailFields&&(o.fields=this.props.placeDetailFields,o.fields.unshift("geometry")),this.placesService.getDetails(o,(function(o,n){if(n===t.googleMaps.places.PlacesServiceStatus.OK){var r=o,a=r.geometry&&r.geometry.location,i=p(p({},e),{gmaps:r,location:{lat:a.lat(),lng:a.lng()}});t.sessionToken=new google.maps.places.AutocompleteSessionToken,t.props.onSuggestSelect&&t.props.onSuggestSelect(i)}}))}else{o={address:e.label,bounds:this.props.bounds,componentRestrictions:this.props.country?{country:this.props.country}:void 0,location:this.props.location};this.geocoder.geocode(o,(function(o,n){if(n===t.googleMaps.GeocoderStatus.OK){var r=o[0],a=r.geometry&&r.geometry.location,i=p(p({},e),{gmaps:r,location:{lat:a.lat(),lng:a.lng()}});t.props.onSuggestSelect&&t.props.onSuggestSelect(i)}}))}},t.prototype.render=function(){var e=this,t=f(this.props),o=r()("geosuggest",this.props.className,{"geosuggest--loading":this.state.isLoading}),n=Object(a.createElement)(g,p({className:this.props.inputClassName,ref:function(t){return e.input=t},value:this.state.userInput,doNotSubmitOnEnter:!this.state.isSuggestsHidden,ignoreTab:this.props.ignoreTab,ignoreEnter:this.props.ignoreEnter,style:this.props.style&&this.props.style.input,onChange:this.onInputChange,onFocus:this.onInputFocus,onBlur:this.onInputBlur,onKeyDown:this.props.onKeyDown,onKeyPress:this.props.onKeyPress,inputType:this.props.inputType,onNext:this.onNext,onPrev:this.onPrev,onSelect:this.onSelect,onEscape:this.hideSuggests,isSuggestsHidden:this.state.isSuggestsHidden,activeSuggest:this.state.activeSuggest,label:this.props.label,id:this.props.id,listId:this.listId},t)),i=Object(a.createElement)(b,{isHidden:this.state.isSuggestsHidden,style:this.props.style&&this.props.style.suggests,suggestItemStyle:this.props.style&&this.props.style.suggestItem,userInput:this.state.userInput,isHighlightMatch:Boolean(this.props.highlightMatch),suggestsClassName:this.props.suggestsClassName,suggestItemClassName:this.props.suggestItemClassName,suggests:this.state.suggests,hiddenClassName:this.props.suggestsHiddenClassName,suggestItemActiveClassName:this.props.suggestItemActiveClassName,activeSuggest:this.state.activeSuggest,onSuggestNoResults:this.onSuggestNoResults,onSuggestMouseDown:this.onSuggestMouseDown,onSuggestMouseOut:this.onSuggestMouseOut,onSuggestSelect:this.selectSuggest,renderSuggestItem:this.props.renderSuggestItem,listId:this.listId});return Object(a.createElement)("div",{className:o,id:this.props.id},Object(a.createElement)("div",{className:"geosuggest__input-wrapper"},n),Object(a.createElement)("div",{className:"geosuggest__suggests-wrapper"},i))},t.defaultProps=m,t}(a.Component),y=o("toolset/block/control");function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function C(e,t){return(C=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=j(e);if(t){var r=j(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return M(this,o)}}function M(e,t){return!t||"object"!==k(t)&&"function"!=typeof t?O(e):t}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var I=wp.i18n.__,E=wp.element.Component,R=window.toolset_map_block_strings,x=function(e){if(!e||e.length<2)return Promise.resolve([]);var t={"subscription-key":window.toolset_maps_address_autocomplete_i10n.azure_api_key,"api-version":"1.0",typeahead:!0,query:e},o="https://atlas.microsoft.com/search/address/json?"+new URLSearchParams(t).toString();return window.fetch(o).then((function(e){return e.json()}),(function(){return Promise.resolve({options:[]})})).then((function(e){var t=e.results,o=_.pluck(t,"address");return _.pluck(o,"freeformAddress").map((function(e){return{value:e,label:e}}))}))},P=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C(e,t)}(a,e);var t,o,n,r=S(a);function a(){var e,t,o,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),e=r.call(this),t=O(e),n=function(){setTimeout((function(){void 0===window.google?e.waitForGoogleToLoad():e.setState({googleLoaded:!0})}),500)},(o="waitForGoogleToLoad")in t?Object.defineProperty(t,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[o]=n,e.state={googleLoaded:void 0!==window.google},e}return t=a,(o=[{key:"componentDidMount",value:function(){"google"!==R.api||this.state.googleLoaded||this.waitForGoogleToLoad()}},{key:"render",value:function(){var e=this.props,t=e.markerAddress,o=e.addressKey,n=e.onChangeMarkerAddress,r=this.state.googleLoaded,a="address-autocomplete-component-"+o,i=t[o],s=function(){return r?React.createElement(v,{id:a,onSuggestSelect:function(e){return n(e,o)},initialValue:i,placeholder:I("Type your address here","toolset-maps")}):null};return React.createElement("div",null,React.createElement("label",{htmlFor:a},I("Marker Address","toolset-maps")),"google"===R.api?React.createElement(s,null):React.createElement(y.AsyncSelect,{id:a,value:{value:i,label:i},defaultOptions:[{value:i,label:i}],onChange:function(e){return n(e,o)},loadOptions:x}))}}])&&w(t.prototype,o),n&&w(t,n),a}(E);function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=H(e);if(t){var r=H(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return L(this,o)}}function L(e,t){return!t||"object"!==T(t)&&"function"!=typeof t?V(e):t}function V(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var U=wp.element.Component,Z=wp.components.BaseControl,K=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(i,e);var t,o,n,a=F(i);function i(){var e;A(this,i);for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return B(V(e=a.call.apply(a,[this].concat(o))),"getOptionValueFromDataImg",(function(e){return/data\x2Dimg="([\s\S]*?)"/.exec(e)[1]})),e}return t=i,(o=[{key:"render",value:function(){var e=this,t=this.props,o=t.label,n=t.className,a=t.selected,i=t.help,s=t.instanceId,c=t.onChange,l=t.options,u="marker-radio-control-".concat(s),p=function(e){return c(e.target.value)};return!!l.length&&React.createElement(Z,{label:o,id:u,help:i,className:r()(n,"marker-radio-control")},React.createElement("ul",null,l.map((function(t,o){return React.createElement("li",{key:"".concat(u,"-").concat(o),className:"marker-radio-control__option"},React.createElement("span",{className:"wpv-icon-img js-wpv-icon-img","data-img":t.value?t.value:e.getOptionValueFromDataImg(t.label),style:{backgroundImage:"url("+(t.value?t.value:e.getOptionValueFromDataImg(t.label))+")",backgroundPositionX:"50%",backgroundPositionY:"center",backgroundRepeat:"no-repeat",backgroundSize:"contain",width:"32px",height:"46px",display:"inline-block"}}),React.createElement("br",null),React.createElement("input",{id:"".concat(u,"-").concat(o),className:"marker-radio-control__input",type:"radio",name:u,value:t.value,onChange:p,checked:t.value===a,"aria-describedby":i?"".concat(u,"__help"):void 0}))}))))}}])&&D(t.prototype,o),n&&D(t,n),i}(U),J=o("./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/edit.js"),z=o("@wordpress/i18n"),W=o("ToolsetDynamicSources"),G=o("toolset/utils"),q=o("@wordpress/element"),Q=o("@wordpress/components");function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var o=[],n=!0,r=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(o.push(i.value),!t||o.length!==t);n=!0);}catch(e){r=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}return o}(e,t)||ee(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X(e,t){var o;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(o=ee(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==o.return||o.return()}finally{if(s)throw a}}}}function ee(e,t){if(e){if("string"==typeof e)return te(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?te(e,t):void 0}}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function oe(e,t,o,n,r,a,i){try{var s=e[a](i),c=s.value}catch(e){return void o(e)}s.done?t(c):Promise.resolve(c).then(n,r)}function ne(e){return function(){var t=this,o=arguments;return new Promise((function(n,r){var a=e.apply(t,o);function i(e){oe(a,n,r,i,s,"next",e)}function s(e){oe(a,n,r,i,s,"throw",e)}i(void 0)}))}}function re(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ae(e,t){return(ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ie(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=le(e);if(t){var r=le(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return se(this,o)}}function se(e,t){return!t||"object"!==$(t)&&"function"!=typeof t?ce(e):t}function ce(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function le(e){return(le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ue(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ae(e,t)}(a,e);var t,o,n,r=ie(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),ue(ce(t=r.call(this,e)),"getStrPosObjects",(function(e,t){var o=t.indexOf(e),n=t.substring(0,o).split(/\r\n|\r|\n/).length-1,r=t.split(/\r\n|\r|\n/)[n].indexOf(e);return{begin:{line:n,ch:r},end:{line:n,ch:r+e.length}}})),ue(ce(t),"save",(function(){t.props.save(t.implodeShortcodes(t.editor.getValue()))})),ue(ce(t),"saveAndExit",(function(){t.props.removeHooks(),t.save()})),ue(ce(t),"cancel",(function(){t.props.removeHooks(),t.props.cancel()})),ue(ce(t),"buildShortcodeMap",function(){var e=ne(regeneratorRuntime.mark((function e(o){var n,r,a,i,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=/\[(.*?)(\s.*?)?\](?:([^\[]+)?\[\/(.*?)\])?/gm,r=o.match(n)){e.next=4;break}return e.abrupt("return");case 4:a=X(r),e.prev=5,a.s();case 7:if((i=a.n()).done){e.next=16;break}return s=i.value,e.next=11,G.ShortcodeRender.render(s,!1,!1,t.props.previewPostId);case 11:(c=e.sent)||(c=s),t.shortcodeMap.set(s,c);case 14:e.next=7;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(5),a.e(e.t0);case 21:return e.prev=21,a.f(),e.finish(21);case 24:case"end":return e.stop()}}),e,null,[[5,18,21,24]])})));return function(t){return e.apply(this,arguments)}}()),ue(ce(t),"expandShortcodes",function(){var e=ne(regeneratorRuntime.mark((function e(o){var n,r,a,i,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.buildShortcodeMap(o);case 2:n=o,r=X(t.shortcodeMap);try{for(r.s();!(a=r.n()).done;)i=Y(a.value,2),s=i[0],c=i[1],n=n.replace(s,c)}catch(e){r.e(e)}finally{r.f()}t.setState({livePreview:n});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ue(ce(t),"implodeShortcodes",(function(e){var o,n=e,r=X(t.shortcodeMap);try{for(r.s();!(o=r.n()).done;){var a=Y(o.value,2),i=a[0],s=a[1];n=n.replace(s,i)}}catch(e){r.e(e)}finally{r.f()}return n})),t.textareaRef=i.a.createRef(),t.shortcodeMap=new Map,t.state={livePreview:""},t}return t=a,(o=[{key:"componentDidMount",value:function(){if(this.textareaRef.current){this.expandShortcodes(this.props.preview.original);var e=window.CodeMirror;this.editor=e.fromTextArea(this.textareaRef.current,{lineNumbers:!0,mode:this.props.mode,matchBrackets:!0,autofocus:!0})}}},{key:"componentDidUpdate",value:function(e,t){this.state.livePreview!==t.livePreview&&this.expandShortcodes(this.state.livePreview),this.editor.setValue(this.state.livePreview),this.editor.setCursor(this.editor.lineCount(),0);var o,n=X(this.shortcodeMap);try{for(n.s();!(o=n.n()).done;){var r=Y(o.value,2),a=(r[0],r[1]),i=this.getStrPosObjects(a,this.editor.getValue());this.editor.markText(i.begin,i.end,{atomic:!0,css:"background-color: #fe3"})}}catch(e){n.e(e)}finally{n.f()}}},{key:"render",value:function(){var e=this,t=this.props,o=window.Toolset,n=t.markerKey,r=t.preview,a=t.title;return i.a.createElement(Q.Modal,{title:a,className:"html-edit-modal",onRequestClose:this.cancel},i.a.createElement("div",{className:"tb-map-fields-and-text-toolset-button"},i.a.createElement(Q.Tooltip,{text:Object(z.__)("Add Field","toolset-maps")},i.a.createElement("button",{className:"components-button tb-icon-button tb-fields-and-text-toolbar-views-add-field",onClick:function(){e.props.addHooks(),e.save(),o.hooks.doAction("wpv-action-wpv-shortcodes-gui-set-gui-action","skip"),o.hooks.doAction("wpv-action-wpv-fields-alt-dialog-do-open")}},i.a.createElement("i",{className:"icon-views-logo fa fa-wpv-paragraph ont-icon-24"})))),i.a.createElement("textarea",{id:"html-edit-textarea-".concat(n),ref:this.textareaRef,defaultValue:r.original}),i.a.createElement("div",{className:"buttons"},i.a.createElement(Q.Button,{isDefault:!0,onClick:this.cancel},Object(z.__)("Cancel","toolset-maps")),i.a.createElement(Q.Button,{isPrimary:!0,onClick:this.saveAndExit},Object(z.__)("Save","toolset-maps"))))}}])&&re(t.prototype,o),n&&re(t,n),a}(q.Component),me=o("@wordpress/block-editor"),de=o("lodash");function fe(e){return(fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ge(e,t){var o;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(o=function(e,t){if(!e)return;if("string"==typeof e)return he(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);"Object"===o&&e.constructor&&(o=e.constructor.name);if("Map"===o||"Set"===o)return Array.from(e);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return he(e,t)}(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){o=e[Symbol.iterator]()},n:function(){var e=o.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==o.return||o.return()}finally{if(s)throw a}}}}function he(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}function be(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ve(e,t){return(ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=Ce(e);if(t){var r=Ce(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return ke(this,o)}}function ke(e,t){return!t||"object"!==fe(t)&&"function"!=typeof t?we(e):t}function we(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ce(e){return(Ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Se(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var _e=window,Me=_e.toolset_map_block_strings,Oe=_e.Toolset,je=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ve(e,t)}(i,e);var t,o,n,a=ye(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),Se(we(t=a.call(this,e)),"addHooks",(function(){Oe.hooks.doAction("wpv-action-wpv-shortcodes-gui-set-gui-action","skip"),Oe.hooks.addAction("wpv-action-wpv-shortcodes-gui-after-do-action",t.addToolsetShortcodeToModalInput,10,2),Oe.hooks.doAction("toolset-action-set-shortcode-gui-action","skip"),Oe.hooks.addAction("toolset-action-after-do-shortcode-gui-action",t.addToolsetShortcodeToModalInput,10,2)})),Se(we(t),"removeHooks",(function(){Oe.hooks.doAction("wpv-action-wpv-shortcodes-gui-set-gui-action","insert"),Oe.hooks.removeAction("wpv-action-wpv-shortcodes-gui-after-do-action",t.addToolsetShortcodeToModalInput),Oe.hooks.doAction("toolset-action-set-shortcode-gui-action","insert"),Oe.hooks.removeAction("toolset-action-after-do-shortcode-gui-action",t.addToolsetShortcodeToModalInput)})),Se(we(t),"addToolsetShortcodeToModalInput",(function(e,o){if("skip"===o){var n=we(t),r=n.props,a=n.state,i=r.attributes,s=r.onChangeMarkerTitle,c=r.onChangePopupContent,l=i.markerTitle,u=i.popupContent,p=a.markerPopupEdit,m=a.markerTitleEdit,d=a.currentlyOpenModal,f=d.type,g=d.key,h=e.hasOwnProperty("shortcode")?e.shortcode:e;"hint"===f?(s(l[g]+h,g),m[g]=!0,t.setState({markerTitleEdit:m})):(c(u[g]+h,g),p[g]=!0,t.setState({markerPopupEdit:p}))}})),t.state={markerTitleEdit:[],markerTitlePreview:[],markerPopupEdit:[],markerPopupPreview:[],shortcodeCache:{},currentAutofocus:null,currentlyOpenModal:{type:null,key:null}},t}return t=i,(o=[{key:"render",value:function(){var e=this,t=this.props,o=t.attributes,n=t.onChangeMapId,a=t.onChangeMapWidth,i=t.onChangeMapHeight,s=t.onChangeMapZoomAutomatic,c=t.onChangeMapZoomLevelForMultipleMarkers,l=t.onChangeMapZoomLevelForSingleMarker,u=t.onChangeMapCenterLat,p=t.onChangeMapCenterLon,m=t.onChangeMapForceCenterSettingForSingleMarker,d=t.onChangeMapMarkerClustering,f=t.onChangeMapMarkerClusteringMinimalNumber,g=t.onChangeMapMarkerClusteringMinimalDistance,h=t.onChangeMapMarkerClusteringMaximalZoomLevel,b=t.onChangeMapMarkerClusteringClickZoom,v=t.onChangeMapMarkerSpiderfying,y=t.onChangeMapDraggable,k=t.onChangeMapScrollable,w=t.onChangeMapDoubleClickZoom,C=t.onChangeMapType,S=t.onChangeMapTypeControl,_=t.onChangeMapZoomControls,M=t.onChangeMapStreetViewControl,O=t.onChangeMapFullScreenControl,j=t.onChangeMapBackgroundColor,I=t.onChangeMapStyle,E=t.onChangeMapLoadingText,R=t.onChangeMapMarkerIcon,x=t.onChangeMapMarkerIconUseDifferentForHover,T=t.onChangeMapMarkerIconHover,A=t.onChangeMapStreetView,D=t.onChangeMarkerId,N=t.onChangeMarkerAddress,F=t.onChangeMarkerSource,L=t.onChangeCurrentVisitorLocationRenderTime,V=t.onAddAnotherMarker,H=t.onRemoveMarker,B=t.onChangeLatitude,U=t.onChangeLongitude,Z=t.onChangeMarkerTitle,$=t.onChangePopupContent,Y=t.onChangeMarkerUseMapIcon,X=t.onChangeMarkerIcon,ee=t.onChangeMarkerIconUseDifferentForHover,te=t.onChangeMarkerIconHover,oe=t.onChangeMarkerDynamicAddress,ne=t.onChangeMarkerView,re=t.getViewBlocks,ae=t.onChangeMarkerViewField,ie=o.markerTitle,se=o.popupContent,ce=this.state,le=ce.markerTitleEdit,ue=ce.markerTitlePreview,fe=ce.markerPopupEdit,he=ce.markerPopupPreview,be=ce.shortcodeCache,ve="google"===Me.api,ye=!o.mapDraggable&&ve,ke=1===o.markerId.length,we=[React.createElement(Q.ToggleControl,{key:"map-interaction-option-scroll",label:Object(z.__)("Scroll inside the map to zoom","toolset-maps"),checked:!!o.mapScrollable,onChange:k}),React.createElement(Q.ToggleControl,{key:"map-interaction-option-double-click-zoom",label:Object(z.__)("Double-click to zoom","toolset-maps"),checked:!!o.mapDoubleClickZoom,onChange:w})];ye&&(we=[React.createElement(Q.Disabled,{key:"map-interaction-options-disabled"},we)]);var Ce=[React.createElement(Q.ToggleControl,{key:"map-interaction-option-draggable",label:Object(z.__)("Move the map by dragging","toolset-maps"),help:ye?Object(z.__)("When this is disabled with Google API, other map interaction options don't work either.","toolset-maps"):"",checked:!!o.mapDraggable,onChange:y})];Ce.push(we);var Se=[],_e=o.markerId.length-1,Oe=!1,je=function(e){return Object(de.map)(e,(function(e,t){return{label:e,value:t}}))},Ie=je(Me.mapStyleOptions),Ee=je(Me.markerOptions),Re=je(Me.addressFields),xe=[{value:"address",label:Object(z.__)("Address","toolset-maps")},{value:"latlon",label:Object(z.__)("GPS Coordinates","toolset-maps")},{value:"dynamic",label:Object(z.__)("Dynamic source","toolset-maps")},{value:"view",label:Object(z.__)("View block","toolset-maps")}];Me.isFrontendServerOverHttps&&xe.push({value:"browser_geolocation",label:Object(z.__)("Location of the current visitor","toolset-maps")});var Pe=function(){return Object(de.filter)(Object(de.concat)(Object(de.map)(re(),(function(e){if(e.attributes.view){var t=e.attributes.view;return{label:t.post_title,value:t.ID}}if(e.attributes.viewId)return{label:wp.data.select(e.attributes.reduxStoreId).getGeneral().name,value:e.attributes.viewId}})),Te()))},Te=function(){var e,t=(e=Object(de.zipObject)(o.markerSource,o.markerView)).view?parseInt(e.view):null;return t&&!Object(de.map)(re(),(function(e){return e.attributes.view?e.attributes.view.ID:e.attributes.viewId?e.attributes.viewId:void 0})).includes(t)?{label:Object(z.__)("- View removed from page -","toolset-maps"),value:t}:null},Ae=function(e){var t,o=null,n=ge(re());try{for(n.s();!(t=n.n()).done;){var r=t.value,a=r.attributes;Number(e)===a.viewId&&(o=wp.data.select(r.attributes.reduxStoreId).getGeneral().preview_post_id)}}catch(e){n.e(e)}finally{n.f()}return o},De=function(t,o,n,r){var a=t[r].replace(/{{/g,"[").replace(/}}/g,"]"),i=function(e,t){return e[t]||(e[t]={original:"",preview:""}),e}(o,r),s=/\[(.*?)(\s.*?)?\](?:([^\[]+)?\[\/(.*?)\])?/gm,c=a.match(s),l=Ae(n[r]);if(i[r].original!==a||i[r].remaining)if(i[r].original=a,c){var u=i[r].preview.match(s),p="";if(""===i[r].preview?(p=c[0],i[r].preview=a):u&&(p=u[0]),p)G.ShortcodeRender.render(p,!1,!1,l).then((function(t){i[r].preview=i[r].preview.replace(p,t),be[p]=t,u=i[r].preview.match(s),i[r].remaining=!!u,e.setState({state:i,shortcodeCache:be})}));else{for(var m in i[r].preview=a,i[r].original=a,be)i[r].preview=i[r].preview.replace(m,be[m]);e.setState({state:i})}}else i[r].preview=a,e.setState({state:i});return i[r].preview},Ne=function(e){return e in le||(le[e]=!1),le[e]},Fe=function(e){return e in fe||(fe[e]=!1),fe[e]},Le=function(t){le[t]=!le[t],e.setState({markerTitleEdit:le})},Ve=function(t){fe[t]=!fe[t],e.setState({markerPopupEdit:fe})};return o.markerId.forEach((function(t,n){var r;Oe=n===_e,Se.push(React.createElement(Q.PanelBody,{key:"marker-panel-"+n,title:Object(z.__)("Marker "+o.markerId[n],"toolset-maps"),initialOpen:Oe},React.createElement(Q.TextControl,{label:Object(z.__)("Marker ID","toolset-maps"),value:o.markerId[n],onChange:function(e){return D(e,n)}}),React.createElement(Q.RadioControl,{label:Object(z.__)("Source for the marker","toolset-maps"),selected:o.markerSource[n]?o.markerSource[n]:"address",onChange:function(e){return F(e,n)},options:xe}),"address"===o.markerSource[n]&&React.createElement(P,{markerAddress:o.markerAddress,addressKey:n,onChangeMarkerAddress:N}),"latlon"===o.markerSource[n]&&React.createElement(q.Fragment,null,React.createElement(Q.TextControl,{label:Object(z.__)("Latitude","toolset-maps"),onChange:function(e){return B(e,n)},value:o.markerLat[n]}),React.createElement(Q.TextControl,{label:Object(z.__)("Longitude","toolset-maps"),onChange:function(e){return U(e,n)},value:o.markerLon[n]})),"browser_geolocation"===o.markerSource[n]&&React.createElement(Q.RadioControl,{label:Object(z.__)("Geolocation options","toolset-maps"),selected:o.currentVisitorLocationRenderTime[n]?o.currentVisitorLocationRenderTime[n]:"immediate",onChange:function(e){return L(e,n)},options:[{value:"immediate",label:Object(z.__)("Render the map immediately and then add visitor location","toolset-maps")},{value:"wait",label:Object(z.__)("Wait until visitors share their location and only then render the map","toolset-maps")}]}),"view"===o.markerSource[n]&&!Object(de.isEmpty)(Pe())&&React.createElement(q.Fragment,null,React.createElement(Q.SelectControl,{label:Object(z.__)("View block","toolset-maps"),value:o.markerView[n],options:Pe(),onChange:function(e){return ne(e,n)}}),React.createElement(Q.SelectControl,{label:Object(z.__)("Field","toolset-maps"),value:o.markerViewField[n],options:Re,onChange:function(e){return ae(e,n)}})),"view"===o.markerSource[n]&&Object(de.isEmpty)(Pe())&&React.createElement(Q.Notice,{status:"warning",isDismissible:!1},React.createElement("p",null,Object(z.__)("You need to add a View block","toolset-maps"))),"dynamic"===o.markerSource[n]&&React.createElement(W.DynamicSourceUnified,{clientId:e.props.clientId,componentId:"marker-".concat(n),dynamicSourcesEligibleAttribute:{condition:"dynamic"===o.markerSource[n],postProvider:o[J.a][n].postProvider,source:o[J.a][n].source,field:o[J.a][n].field,customPost:o[J.a][n].customPost,toggleHide:!0,fieldSelectedCallback:function(e){oe(e,n)},category:"text"}}),!!Ne(n)&&React.createElement(pe,{mode:"htmlmixed",title:Object(z.__)("Hint content (displayed on hover)","toolset-maps"),code:ie[n],save:function(e){Z(e,n),Le(n)},cancel:function(){return Le(n)},addHooks:e.addHooks,removeHooks:e.removeHooks,markerKey:n,preview:ue[n],previewPostId:Ae(o.markerView[n])}),React.createElement(Q.BaseControl,{id:"hint-content-"+n,label:Object(z.__)("Hint content (displayed on hover)","toolset-maps")},!Ne(n)&&React.createElement(Q.Button,{isLink:!0,onClick:function(){le[n]=!0,e.setState({markerTitleEdit:le,currentAutofocus:"hint-content-"+n,currentlyOpenModal:{type:"hint",key:n}})}},Object(z.__)("Edit","toolset-maps")),React.createElement("div",{className:"tb-map-preview"},React.createElement("label",{className:"tb-map-preview-label",htmlFor:"hint-content-preview-"+n},Object(z.__)("Preview","toolset-maps")),React.createElement("div",{className:"tb-map-preview-body",id:"hint-content-preview-"+n},De(ie,ue,o.markerView,n)))),!!Fe(n)&&React.createElement(pe,{mode:"htmlmixed",title:Object(z.__)("Pop-up content","toolset-maps"),code:se[n],save:function(e){$(e,n),Ve(n)},cancel:function(){return Ve(n)},addHooks:e.addHooks,removeHooks:e.removeHooks,markerKey:n,preview:he[n],previewPostId:Ae(o.markerView[n])}),React.createElement(Q.BaseControl,{id:"popup-content-"+n,label:Object(z.__)("Pop-up content","toolset-maps")},!Fe(n)&&React.createElement(Q.Button,{isLink:!0,onClick:function(){fe[n]=!0,e.setState({markerPopupEdit:fe,currentAutofocus:"popup-content-"+n,currentlyOpenModal:{type:"popup",key:n}})}},Object(z.__)("Edit","toolset-maps")),React.createElement("div",{className:"tb-map-preview"},React.createElement("label",{className:"tb-map-preview-label",htmlFor:"pop-up-content-preview"+n},Object(z.__)("Preview","toolset-maps")),React.createElement("div",{className:"tb-map-preview-body",id:"pop-up-content-preview"+n},De(se,he,o.markerView,n)))),React.createElement(Q.ToggleControl,{label:Object(z.__)("Use the map's icon settings","toolset-maps"),checked:!!o.markerUseMapIcon[n],onChange:function(){return Y(n)}}),!o.markerUseMapIcon[n]&&React.createElement(K,{label:Object(z.__)("Marker icon","toolset-maps"),options:Ee,selected:(r=o.markerIcon[n],"default"===r?"":r),onChange:function(e){return X(e,n)},instanceId:"marker-icon"}),!o.markerUseMapIcon[n]&&React.createElement(Q.ToggleControl,{label:Object(z.__)("Use a different marker icon on hover","toolset-maps"),checked:!!o.markerIconUseDifferentForHover[n],onChange:function(){return ee(n)}}),!o.markerUseMapIcon[n]&&!!o.markerIconUseDifferentForHover[n]&&React.createElement(K,{label:Object(z.__)("Icon when hovering this marker","toolset-maps"),options:Ee,selected:o.markerIconHover[n],onChange:function(e){return te(e,n)},instanceId:"marker-icon-hover"}),React.createElement(Q.Button,{isLink:!0,id:"remove-marker-"+n,className:"remove-marker-button",onClick:function(e){return H(n,e)}},Object(z.__)("Remove this marker","toolset-maps"))))})),React.createElement(me.InspectorControls,null,React.createElement("div",{className:r()("wp-block-toolset-map-inspector")},React.createElement(Q.PanelBody,{title:Object(z.__)("Map","toolset-maps")+" "+o.mapId},React.createElement(Q.TextControl,{label:Object(z.__)("Map ID","toolset-maps"),value:o.mapId,onChange:n}),!o.align&&React.createElement(Q.TextControl,{label:Object(z.__)("Width","toolset-maps"),value:o.mapWidth,onChange:a,help:Object(z.__)("Use percentages or units (defaults to pixels).","toolset-maps")}),React.createElement(Q.TextControl,{label:Object(z.__)("Height","toolset-maps"),value:o.mapHeight,onChange:i,help:Object(z.__)("Use percentages or units (defaults to pixels).","toolset-maps")}),React.createElement(Q.ToggleControl,{label:Object(z.__)("Adjust zoom and center to show all markers at once","toolset-maps"),checked:!!o.mapZoomAutomatic,onChange:s}),!o.mapZoomAutomatic&&React.createElement(Q.RangeControl,{label:Object(z.__)("Zoom level for multiple markers","toolset-maps"),value:o.mapZoomLevelForMultipleMarkers,onChange:c,min:1,max:18}),React.createElement(Q.RangeControl,{label:Object(z.__)("Zoom level for one marker","toolset-maps"),value:o.mapZoomLevelForSingleMarker,onChange:l,min:1,max:18}),!o.mapZoomAutomatic&&React.createElement(Q.TextControl,{type:"number",label:Object(z.__)("Center latitude","toolset-maps"),value:o.mapCenterLat,onChange:u}),!o.mapZoomAutomatic&&React.createElement(Q.TextControl,{type:"number",label:Object(z.__)("Center longitude","toolset-maps"),value:o.mapCenterLon,onChange:p}),!o.mapZoomAutomatic&&ke&&React.createElement(Q.ToggleControl,{label:Object(z.__)("Force the map center setting even when only one marker is used","toolset-maps"),checked:!!o.mapForceCenterSettingForSingleMarker,onChange:m}),React.createElement(Q.ToggleControl,{label:Object(z.__)("Cluster markers","toolset-maps"),checked:!!o.mapMarkerClustering,onChange:d}),!!ve&&o.mapMarkerClustering&&React.createElement(Q.RangeControl,{label:Object(z.__)("Minimal number of markers in a cluster","toolset-maps"),value:o.mapMarkerClusteringMinimalNumber,onChange:f,min:2,max:20}),!!ve&&o.mapMarkerClustering&&React.createElement(Q.RangeControl,{label:Object(z.__)("Minimal distance, in pixels, between markers","toolset-maps"),value:o.mapMarkerClusteringMinimalDistance,onChange:g,min:10,max:100}),!!ve&&o.mapMarkerClustering&&React.createElement(Q.RangeControl,{label:Object(z.__)("Maximal map zoom level that allows clustering","toolset-maps"),value:o.mapMarkerClusteringMaximalZoomLevel,onChange:h,min:1,max:18}),!!ve&&o.mapMarkerClustering&&React.createElement(Q.ToggleControl,{label:Object(z.__)("Zoom the map when clicking on a cluster icon","toolset-maps"),checked:!!o.mapMarkerClusteringClickZoom,onChange:b}),!!ve&&React.createElement(Q.ToggleControl,{label:Object(z.__)("Spiderfy overlapping markers","toolset-maps"),help:Object(z.__)("Overlapping markers spring apart gracefully (on click).","toolset-maps"),checked:!!o.mapMarkerSpiderfying,onChange:v}),Ce,!!ve&&React.createElement(Q.RadioControl,{label:Object(z.__)("Map type","toolset-maps"),selected:o.mapType?o.mapType:"roadmap",onChange:C,options:[{value:"roadmap",label:Object(z.__)("Map (default view)","toolset-maps")},{value:"satellite",label:Object(z.__)("Satellite","toolset-maps")},{value:"hybrid",label:Object(z.__)("Mix of Map & Satellite","toolset-maps")},{value:"terrain",label:Object(z.__)("Terrain","toolset-maps")}]}),!!ve&&React.createElement(Q.ToggleControl,{label:Object(z.__)("Map type controls","toolset-maps"),checked:!!o.mapTypeControl,onChange:S}),!!ve&&React.createElement(Q.ToggleControl,{label:Object(z.__)("Zoom controls","toolset-maps"),checked:!!o.mapZoomControls,onChange:_}),!!ve&&React.createElement(Q.ToggleControl,{label:Object(z.__)("Street View control","toolset-maps"),checked:!!o.mapStreetViewControl,onChange:M}),!!ve&&React.createElement(Q.ToggleControl,{label:Object(z.__)("Full Screen control","toolset-maps"),checked:!!o.mapFullScreenControl,onChange:O}),!!ve&&React.createElement(Q.SelectControl,{label:Object(z.__)("Map style","toolset-maps"),value:o.mapStyle,options:Ie,onChange:I}),!!ve&&React.createElement(Q.ToggleControl,{label:Object(z.__)("Open Street View when this map loads","toolset-maps"),help:Object(z.__)("First marker added to this map will be used as location.","toolset-maps"),checked:!!o.mapStreetView,onChange:A}),React.createElement(Q.TextareaControl,{label:Object(z.__)("Text to show while the map is loading","toolset-maps"),value:o.mapLoadingText,onChange:E}),React.createElement(Q.PanelRow,null,React.createElement("label",{htmlFor:"map-background-color"},Object(z.__)("Background color","toolset-maps")),React.createElement(Q.ColorIndicator,{id:"map-background-color",colorValue:o.mapBackgroundColor})),React.createElement(Q.ColorPalette,{colors:Me.themeColors[0],value:o.mapBackgroundColor,onChange:j}),React.createElement(K,{label:Object(z.__)("Marker icon","toolset-maps"),options:Ee,selected:o.mapMarkerIcon,onChange:R,instanceId:"map-marker-icon"}),React.createElement(Q.ToggleControl,{label:Object(z.__)("Use a different marker icon on hover","toolset-maps"),checked:!!o.mapMarkerIconUseDifferentForHover,onChange:x}),!!o.mapMarkerIconUseDifferentForHover&&React.createElement(K,{label:Object(z.__)("Marker icon on hover","toolset-maps"),options:Ee,selected:o.mapMarkerIconHover,onChange:T,instanceId:"map-marker-icon-hover"})),Se,React.createElement(Q.PanelBody,null,React.createElement(Q.Button,{isPrimary:!0,id:"add-another-marker",onClick:V},Object(z.__)("Add marker","toolset-maps")))))}}])&&be(t.prototype,o),n&&be(t,n),i}(q.Component)},"./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/render/server-side-render-map.js":function(e,t,o){"use strict";var n=o("@wordpress/components"),r=o("@wordpress/compose"),a=o("@wordpress/data"),i=o("@wordpress/element"),s=o("lodash");function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t,o){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,o){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(o):r.value}})(e,t,o||e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=g(e);if(t){var r=g(this).constructor;o=Reflect.construct(n,arguments,r)}else o=n.apply(this,arguments);return d(this,o)}}function d(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?f(e):t}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=window.toolset_map_block_strings,b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(i,e);var t,o,r,a=m(i);function i(e,t){var o,n,r,c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o=a.call(this,e,t),n=f(o),r="debouncedInitMapById",c=Object(s.debounce)(window.WPViews.view_addon_maps.initMapById,500),r in n?Object.defineProperty(n,r,{value:c,enumerable:!0,configurable:!0,writable:!0}):n[r]=c,o.state={firstRender:!0,needToLazyLoadAtlas:"azure"===h.api&&void 0===window.atlas},o}return t=i,(o=[{key:"componentDidMount",value:function(){var e=this;this.state.needToLazyLoadAtlas&&(jQuery("<link/>",{rel:"stylesheet",type:"text/css",href:"https://atlas.microsoft.com/sdk/js/atlas.min.css?api-version=1.1"}).appendTo("head"),jQuery.getScript("https://atlas.microsoft.com/sdk/js/atlas.min.js?api-version=1.1").done((function(){e.setState({needToLazyLoadAtlas:!1})})))}},{key:"difference",value:function(e,t){var o=this;return Object(s.transform)(e,(function(e,n,r){Object(s.isEqual)(n,t[r])||(e[r]=Object(s.isObject)(n)&&Object(s.isObject)(t[r])?o.difference(n,t[r]):n)}))}},{key:"shouldComponentUpdate",value:function(e,t){if(t.firstRender)return this.setState({firstRender:!1}),!0;var o=e.attributes,n=this.difference(o,this.props.attributes);if(n.hasOwnProperty("markerSource")){var r=JSON.parse(n.markerSource).indexOf("dynamic");if(-1!==r){var a=JSON.parse(o.markerDynamicAddress)[r];if(Object(s.isEmpty)(a))return!1}}return!Object(s.isEqual)(this.props,e)||!Object(s.isEqual)(this.state,t)}},{key:"componentDidUpdate",value:function(e,t,o){"function"==typeof u(g(i.prototype),"componentDidUpdate",this)&&u(g(i.prototype),"componentDidUpdate",this).call(this,e,t,o),this.state.needToLazyLoadAtlas||this.debouncedInitMapById(this.props.attributes.mapId)}},{key:"render",value:function(){return React.createElement(n.ServerSideRender,{key:this.props.key,block:this.props.block,attributes:this.props.attributes,urlQueryArgs:this.props.urlQueryArgs})}}])&&l(t.prototype,o),r&&l(t,r),i}(i.Component),v=Object(r.compose)([Object(a.withSelect)((function(e){var t=e("core/editor").getCurrentPostId;return{urlQueryArgs:{post_id:(0,e(window.toolsetDynamicSourcesScriptData.dynamicSourcesStore).getPreviewPost)()||t()}}}))])(b);t.a=v},"./application/controllers/compatibility/gutenberg/editor-blocks/blocks/map/styles/editor.scss":function(e,t,o){},"./node_modules/classnames/index.js":function(e,t,o){var n;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var o={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var a=typeof n;if("string"===a||"number"===a)e.push(n);else if(Array.isArray(n)&&n.length){var i=r.apply(null,n);i&&e.push(i)}else if("object"===a)for(var s in n)o.call(n,s)&&n[s]&&e.push(s)}}return e.join(" ")}e.exports?(r.default=r,e.exports=r):void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()},"./node_modules/lodash.debounce/index.js":function(e,t,o){(function(t){var o=/^\s+|\s+$/g,n=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,a=/^0o[0-7]+$/i,i=parseInt,s="object"==typeof t&&t&&t.Object===Object&&t,c="object"==typeof self&&self&&self.Object===Object&&self,l=s||c||Function("return this")(),u=Object.prototype.toString,p=Math.max,m=Math.min,d=function(){return l.Date.now()};function f(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function g(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==u.call(e)}(e))return NaN;if(f(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=f(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var s=r.test(e);return s||a.test(e)?i(e.slice(2),s?2:8):n.test(e)?NaN:+e}e.exports=function(e,t,o){var n,r,a,i,s,c,l=0,u=!1,h=!1,b=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function v(t){var o=n,a=r;return n=r=void 0,l=t,i=e.apply(a,o)}function y(e){return l=e,s=setTimeout(w,t),u?v(e):i}function k(e){var o=e-c;return void 0===c||o>=t||o<0||h&&e-l>=a}function w(){var e=d();if(k(e))return C(e);s=setTimeout(w,function(e){var o=t-(e-c);return h?m(o,a-(e-l)):o}(e))}function C(e){return s=void 0,b&&n?v(e):(n=r=void 0,i)}function S(){var e=d(),o=k(e);if(n=arguments,r=this,c=e,o){if(void 0===s)return y(c);if(h)return s=setTimeout(w,t),v(c)}return void 0===s&&(s=setTimeout(w,t)),i}return t=g(t)||0,f(o)&&(u=!!o.leading,a=(h="maxWait"in o)?p(g(o.maxWait)||0,t):a,b="trailing"in o?!!o.trailing:b),S.cancel=function(){void 0!==s&&clearTimeout(s),l=0,n=c=r=s=void 0},S.flush=function(){return void 0===s?i:C(d())},S}}).call(this,o("./node_modules/webpack/buildin/global.js"))},"./node_modules/webpack/buildin/global.js":function(e,t){var o;o=function(){return this}();try{o=o||new Function("return this")()}catch(e){"object"==typeof window&&(o=window)}e.exports=o},"@wordpress/block-editor":function(e,t){e.exports=window.wp.blockEditor},"@wordpress/components":function(e,t){e.exports=window.wp.components},"@wordpress/compose":function(e,t){e.exports=window.wp.compose},"@wordpress/data":function(e,t){e.exports=window.wp.data},"@wordpress/editor":function(e,t){e.exports=window.wp.editor},"@wordpress/element":function(e,t){e.exports=window.wp.element},"@wordpress/hooks":function(e,t){e.exports=window.wp.hooks},"@wordpress/i18n":function(e,t){e.exports=window.wp.i18n},ToolsetDynamicSources:function(e,t){e.exports=ToolsetDynamicSources},lodash:function(e,t){e.exports=lodash},react:function(e,t){e.exports=React},"toolset/block/control":function(e,t){e.exports=window.toolsetCommonEs.block.control},"toolset/utils":function(e,t){e.exports=window.toolsetCommonEs.utils}});